# Reference this view as main__dim_pets
schema: main
table_name: dim_pets

dimensions:
  pet_name: {}
  birth_date: {}
  gender: {}
  weight_lbs: {}
  color: {}
  microchip_number: {}
  spayed_neutered: {}
  special_needs: {}
  temperament: {}
  dietary_restrictions: {}
  favorite_toy: {}
  favorite_treat: {}
  emergency_vet_name: {}
  emergency_vet_phone: {}
  last_vaccination_date: {}
  registration_date: {}
  active_status: {}
  profile_photo_url: {}

  age_years:
    sql: DATEDIFF('year', ${birth_date}, CURRENT_DATE)
    label: Age (years)

  pet_id:
    format: ID

  customer_id:
    format: ID
    hidden: true

  breed_id:
    format: ID
    hidden: true

  pet_type_id:
    format: ID
    hidden: true

measures:
  count:
    aggregate_type: count

  total_pets:
    sql: ${pet_id}
    label: Total Pets
    aggregate_type: count_distinct

  avg_pet_age:
    sql: ${age_years}
    label: Avg Pet Age
    aggregate_type: average

  avg_weight:
    sql: ${weight_lbs}
    label: Avg Weight
    aggregate_type: average

  weight_category_branch_not_workbook_:
    sql: CASE WHEN ${main__dim_pets.avg_weight} < 20 THEN 'Light' ELSE CASE WHEN
      ${main__dim_pets.avg_weight} < 50 THEN 'Medium' ELSE 'Heavy' END END
    label: "Weight Category "
  # pets_per_customer:
  #   sql: ${total_pets} / NULLIF(${main__dim_customers.total_customers}, 0)
  #   label: Pets per Customer
